name: Gemini AI PR Reviewer

on:
  push:
    branches:
      - master
  pull_request:
    types: [opened, synchronize]
  issue_comment:
    types: [created]

permissions:
  contents: read
  pull-requests: write

jobs:
  review:
    # Only run on PRs or when someone comments "/gemini-review"
    if: github.event_name == 'pull_request' || contains(github.event.comment.body, '/gemini-review')
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v4

      - name: Gemini PR Review
        uses: google-github-actions/run-gemini-cli@v0
        with:
          gemini_model: "gemini-1.5-flash" # Best balance of speed and free quota
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          review_type: "code_quality"
          custom_prompt: |
            You are a Senior Web Developer mentoring a fresher. Review the code for fundamental best practices:
            1. **HTML Semantics:** Ensure use of proper tags (e.g., <button> vs <a>, <main>, <nav>, <section>) and accessible attributes like 'alt' for images.
            2. **CSS Quality:** Check for DRY (Don't Repeat Yourself) principles, proper use of units (rem/em over px), and avoiding ID selectors for styling.
            3. **JavaScript Basics:** Check for clean variable naming, use of 'const' and 'let' (no 'var'), and proper error handling in fetch/async calls.
            4. **Code Cleanliness:** Flag "dead code" (unused variables/commented-out blocks) and ensure consistent indentation.
            5. **Project Structure:** Ensure logic and styling are separated (no inline styles).

            Keep your tone encouraging and explain *why* a change is suggested so the developer can learn.
